{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import axios from 'axios';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\n\nconst searchForm = document.querySelector('.search-form');\nconst imageList = document.querySelector('.gallery');\nconst nextBtn = document.querySelector('.next-btn');\nconst loader = document.querySelector('.loader');\n    \nlet currentPage = 0;\nlet searchValue = '';\n    \nconst gallery = new SimpleLightbox('.gallery a', {\n    captionsData: 'alt',\n    captionDelay: 250,\n});\n\nsearchForm.addEventListener('submit', handleSearch);\nnextBtn.addEventListener('click', nextPage);\n  \nasync function handleSearch(event) {\n    event.preventDefault();\n    searchValue = event.currentTarget.elements.query.value.trim();\n    currentPage = 1;\n    showLoader();     \n    nextBtn.classList.add('is-hidden');\n    imageList.innerHTML = '';\nif (!searchValue) {\niziToast.show({\n    title: '❕',\n    theme: 'light',\n    message: `Please, fill in the search field`,\n    messageSize: '20px',\n    messageColor: '#808080',\n    backgroundColor: '#e7fc44',\n    position: 'topLeft',\n    timeout: 3000,\n});\n    return;\n}\ntry {\n    const response = await fetchImages(searchValue, currentPage);\nif (response.hits.length === 0) {\niziToast.show({\n    message:\n     'Sorry, there are no images matching your search query. Please try again!',\n    messageSize: '16px',\n    messageColor: 'white',\n    backgroundColor: '#EF4040',\n    position: 'topRight',\n    timeout: 5000,\n});\nsearchForm.reset();\n    return;\n}\nimageList.insertAdjacentHTML('beforeend', createMarkup(response.hits));\ngallery.refresh();\n            \nif (response.hits.length >= 40) {\n    nextBtn.classList.remove('is-hidden');\n}  else {\niziToast.show({\n    title: '❕',\n    theme: 'dark',\n    message: \"We're sorry, but you've reached the end of search results.\",\n    messageSize: '16px',\n    messageColor: 'white',\n    backgroundColor: '#4e75ff',\n    position: 'topRight',\n    timeout: 5000,\n});\n  }\n  searchForm.reset();\n} catch (err) {\n    handleError(err);\n} finally {\n    hideLoader();\n}\n}\n\nasync function fetchImages(query, page) {\n    const BASE_URL = 'https://pixabay.com/api/';\n    const KEY = '41927866-cfb01af7ede59fae11104cea9';\n\nconst res = await axios.get(BASE_URL, {\n    params: {\n        key: KEY,\n        q: query,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        per_page: 40,\n        page: page,\n    },\n});\n      \n    return res.data;\n}\n\nfunction createMarkup(hits) {\nreturn hits\n    .map(\n    ({\n        comments,\n        downloads,\n        largeImageURL,\n        likes,\n        webformatURL,\n        tags,\n        views,\n    }) =>\n    `<li class=\"gallery-item\">\n        <a class=\"gallery-link\" href=\"${largeImageURL}\">\n            <img class=\"gallery-image\" src=\"${webformatURL}\" alt=\"${tags}\">\n            <ul class=\"gallery-description\">\n              <li class=\"gallery-description-item\">Likes: <span class=\"discrp-item\">${likes}</span> </li>\n              <li class=\"gallery-description-item\">Views: <span class=\"discrp-item\">${views}</span></li>\n              <li class=\"gallery-description-item\">Downloads: <span class=\"discrp-item\">${downloads}</span></li>\n              <li class=\"gallery-description-item\">Comments: <span class=\"discrp-item\">${comments}</span></li>\n            </ul>\n        </a>\n    </li>`\n    )\n    .join('');\n  }\n\nfunction handleError(err) {\nconsole.error(err);\nimageList.innerHTML = '';\niziToast.show({\n    // iconUrl: icon,\n    theme: 'dark',\n    message: err.stack,\n    messageSize: '16px',\n    messageColor: 'white',\n    backgroundColor: '#EF4040',\n    position: 'topRight',\n    timeout: 5000,\n});\n    nextBtn.removeEventListener('click', nextPage);\n    nextBtn.classList.add('is-hidden');\n}\n    \nasync function nextPage() {\n    loader.classList.remove('is-hidden');\n    nextBtn.classList.add('is-hidden');\n    currentPage += 1;\n    showLoader();    \ntry {\n    const res = await fetchImages(searchValue, currentPage);\nif (currentPage * 40 >= res.totalHits) {\niziToast.show({\n    title: '❕',\n    theme: 'dark',\n    message: \"We're sorry, but you've reached the end of search results.\",\n    messageSize: '16px',\n    messageColor: 'white',\n    backgroundColor: '#4e75ff',\n    position: 'topRight',\n    timeout: 5000,\n});\n\nif (res.hits.length > 0) {\n    imageList.insertAdjacentHTML('beforeend', createMarkup(res.hits));\n    gallery.refresh();\n    nextBtn.classList.add('is-hidden');\n    scrollBy();\n    return;\n}\n} else {\n    imageList.insertAdjacentHTML('beforeend', createMarkup(res.hits));\n    gallery.refresh();\n    scrollBy();\n    nextBtn.classList.remove('is-hidden');\n}\n} catch (err) {\n    handleError(err);\n} finally {\n    hideLoader();\n    loader.classList.add('is-hidden');\n    }\n}\nfunction hideLoader() {\n    setTimeout(() => {\n    loader.style.display = 'none';\n  }, 500);\n}\n\nfunction showLoader() {\n  loader.style.display = 'block';\n}\nfunction scrollBy() {\n  window.scrollBy({\n    top: 640,\n    behavior: 'smooth',\n  });\n}"],"names":["searchForm","imageList","nextBtn","loader","currentPage","searchValue","gallery","SimpleLightbox","handleSearch","nextPage","event","showLoader","iziToast","response","fetchImages","createMarkup","err","handleError","hideLoader","query","page","BASE_URL","KEY","axios","hits","comments","downloads","largeImageURL","likes","webformatURL","tags","views","res","scrollBy"],"mappings":"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"}