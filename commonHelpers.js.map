{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import axios from 'axios';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\ndocument.addEventListener('DOMContentLoaded', () => {\n    const form = document.querySelector('.form');\n    const imageList = document.querySelector('.gallery');\n    const loader = document.createElement('div');\n    const nextBtn = document.querySelector('#next-btn');\n    \n    let currentPage = 0;\n    let searchValue = '';\n    \n    const gallery = new SimpleLightbox('.gallery a', {\n        captionsData: 'alt',\n        captionDelay: 250,\n    });\n\n    form.addEventListener('submit', handleSearch);\n    nextBtn.addEventListener('click', nextPage);\n  \n    async function handleSearch(event) {\n        event.preventDefault();\n\n        const searchInput = form.elements.input.value;\n\n        searchValue = searchInput;\n        currentPage = 1;\n\n        nextBtn.classList.add('is-hidden');\n        \n        imageList.innerHTML = '';\n\n        if (!searchInput.trim()) {\n            iziToast.warning({\n                title: 'Warning',\n                message: 'Please enter a search query.',\n                messageSize: '20px',\n                messageColor: '#808080',\n                backgroundColor: '#e7fc44',\n                position: 'topLeft',\n                timeout: 3000,\n            });\n            return;\n        }\n\n        showLoader();\n\n        try {\n            const response = await fetchImages(searchValue, currentPage);\n            if (response.hits.length === 0) {\n                iziToast.show({\n                    message:\n                        'Sorry, there are no images matching your search query. Please try again!',\n                    messageSize: '16px',\n                    messageColor: 'white',\n                    backgroundColor: '#EF4040',\n                    position: 'topRight',\n                    timeout: 5000,\n                });\n                form.reset();\n                return;\n            }\n            imageList.innerHTML = createMarkup(response.hits);\n            gallery.refresh();\n            \n            if (response.hits.length >= 40) {\n                nextBtn.classList.remove('is-hidden');\n            }\n\n            scrollBy();\n            form.reset();\n        } catch (err) {\n            handleError(err);\n        } finally {\n            hideLoader();\n        }\n    }\n\n    async function fetchImages(value, page) {\n        const BASE_URL = 'https://pixabay.com/api/';\n        const KEY = '41927866-cfb01af7ede59fae11104cea9';\n\n        const res = await axios.get(BASE_URL, {\n            params: {\n                key: KEY,\n                q: value,\n                image_type: 'photo',\n                orientation: 'horizontal',\n                safesearch: true,\n                per_page: 40,\n                page: page,\n            },\n        });\n      \n        return res.data;\n    }\n\n    function createMarkup(hits) {\n    return hits\n      .map(\n        ({\n          comments,\n          downloads,\n          largeImageURL,\n          likes,\n          webformatURL,\n          tags,\n          views,\n        }) =>\n          `<li class=\"gallery-item\">\n          <a class=\"gallery-link\" href=\"${largeImageURL}\">\n            <img class=\"gallery-image\" src=\"${webformatURL}\" alt=\"${tags}\">\n            <ul class=\"gallery-item-description\">\n              <li>Likes: ${likes}</li>\n              <li>Views: ${views}</li>\n              <li>Downloads: ${downloads}</li>\n              <li>Comments: ${comments}</li>\n            </ul>\n          </a>\n        </li>`\n      )\n      .join('');\n  }\n\n    function handleError(err) {\n        console.error(err);\n        imageList.innerHTML = '';\n        iziToast.show({\n            iconUrl: icon,\n            theme: 'dark',\n            message: err.stack,\n            messageSize: '16px',\n            messageColor: 'white',\n            backgroundColor: '#EF4040',\n            position: 'topRight',\n            timeout: 5000,\n        });\n        nextBtn.removeEventListener('click', nextPage);\n        nextBtn.classList.add('is-hidden');\n    }\n\n\n    function showLoader() {\n        loader.classList.remove('hidden');\n    }\n    function hideLoader() {\n        loader.classList.add('hidden');\n    }\n\n    async function nextPage() {\n    loader.classList.remove('is-hidden');\n    nextBtn.classList.add('is-hidden');\n    currentPage += 1;\n\n    try {\n     const res = await fetchImages(searchValue, currentPage);\n\n    if (currentPage * 40 >= res.totalHits) {\n     iziToast.show({\n      title: '‚ùï',\n      theme: 'dark',\n      message: \"We're sorry, but you've reached the end of search results.\",\n      messageSize: '16px',\n      messageColor: 'white',\n      backgroundColor: '#4e75ff',\n      position: 'topRight',\n      timeout: 5000,\n    });\n        imageList.innerHTML += createMarkup(res.hits);\n        gallery.refresh();\n        nextBtn.classList.add('is-hidden');\n\n        scrollBy();\n\n        return;\n    }\n\n        imageList.innerHTML += createMarkup(res.hits);\n        gallery.refresh();\n\n        scrollBy();\n\n        nextBtn.classList.remove('is-hidden');\n    } catch (err) {\n        handleError(err);\n    } finally {\n        loader.classList.add('is-hidden');\n    }\n}\n});\n\n"],"names":["form","imageList","loader","nextBtn","currentPage","searchValue","gallery","SimpleLightbox","handleSearch","nextPage","event","searchInput","iziToast","showLoader","response","fetchImages","createMarkup","err","handleError","hideLoader","value","page","BASE_URL","KEY","axios","hits","comments","downloads","largeImageURL","likes","webformatURL","tags","views","res"],"mappings":"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"}