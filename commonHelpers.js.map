{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import axios from 'axios';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\n\nconst searchForm = document.querySelector('.search-form');\nconst imageList = document.querySelector('.gallery');\nconst nextBtn = document.querySelector('.next-btn');\n    \nlet currentPage = 0;\nlet searchValue = '';\n    \nconst gallery = new SimpleLightbox('.gallery a', {\n    captionsData: 'alt',\n    captionDelay: 250,\n});\n\nsearchForm.addEventListener('submit', handleSearch);\nnextBtn.addEventListener('click', nextPage);\n  \nasync function handleSearch(event) {\n    event.preventDefault();\n\n    const searchInput = searchForm.elements.query.value;\n\n    searchValue = searchInput;\n    currentPage = 1;\n\n    nextBtn.classList.add('is-hidden');\n        \n    imageList.innerHTML = '';\n    // showLoader();\nif (!searchInput.trim()) {\n    iziToast.show({\n      title: '❕',\n      theme: 'light',\n      message: `Please, fill in the search field`,\n      messageSize: '20px',\n      messageColor: '#808080',\n      backgroundColor: '#e7fc44',\n      position: 'topLeft',\n      timeout: 3000,\n});\n    return;\n}\n\n    showLoader();\n\ntry {\n    const response = await fetchImages(searchValue, currentPage);\nif (response.hits.length === 0) {\n    iziToast.show({\n        message:\n            'Sorry, there are no images matching your search query. Please try again!',\n        messageSize: '16px',\n        messageColor: 'white',\n        backgroundColor: '#EF4040',\n        position: 'topRight',\n        timeout: 5000,\n});\n    searchForm.reset();\n    return;\n}\n    imageList.innerHTML = createMarkup(response.hits);\n    gallery.refresh();\n            \nif (response.hits.length >= 40) {\n    nextBtn.classList.remove('is-hidden');\n}  else {\n    iziToast.show({\n        title: '❕',\n        theme: 'dark',\n        message: \"We're sorry, but you've reached the end of search results.\",\n        messageSize: '16px',\n        messageColor: 'white',\n        backgroundColor: '#4e75ff',\n        position: 'topRight',\n        timeout: 5000,\n});\n\n    }\n\n        scrollBy();\n        searchForm.reset();\n    } catch (err) {\n        handleError(err);\n    } finally {\n        hideLoader();\n            // nextBtn.classList.add('is-hidden');\n    }\n}\n\nasync function fetchImages(query, page) {\n    const BASE_URL = 'https://pixabay.com/api/';\n    const KEY = '41927866-cfb01af7ede59fae11104cea9';\n\n    const res = await axios.get(BASE_URL, {\n    params: {\n        key: KEY,\n        q: query,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        per_page: 40,\n        page: page,\n    },\n});\n      \n        return res.data;\n    }\n\n    function createMarkup(hits) {\n    return hits\n      .map(\n        ({\n          comments,\n          downloads,\n          largeImageURL,\n          likes,\n          webformatURL,\n          tags,\n          views,\n        }) =>\n          `<li class=\"gallery-item\">\n          <a class=\"gallery-link\" href=\"${largeImageURL}\">\n            <img class=\"gallery-image\" src=\"${webformatURL}\" alt=\"${tags}\">\n            <ul class=\"gallery-description\">\n              <li class=\"gallery-description-item\">Likes: <span class=\"discrp-item\">${likes}</span> </li>\n              <li class=\"gallery-description-item\">Views: <span class=\"discrp-item\">${views}</span></li>\n              <li class=\"gallery-description-item\">Downloads: <span class=\"discrp-item\">${downloads}</span></li>\n              <li class=\"gallery-description-item\">Comments: <span class=\"discrp-item\">${comments}</span></li>\n            </ul>\n          </a>\n        </li>`\n      )\n      .join('');\n  }\n\n    function handleError(err) {\n        console.error(err);\n        imageList.innerHTML = '';\n        iziToast.show({\n            // iconUrl: icon,\n            theme: 'dark',\n            message: err.stack,\n            messageSize: '16px',\n            messageColor: 'white',\n            backgroundColor: '#EF4040',\n            position: 'topRight',\n            timeout: 5000,\n        });\n        nextBtn.removeEventListener('click', nextPage);\n        nextBtn.classList.add('is-hidden');\n}\n    \nasync function nextPage() {\n    loader.classList.remove('is-hidden');\n    nextBtn.classList.add('is-hidden');\n    currentPage += 1;\n    showLoader();\n    \ntry {\n    const res = await fetchImages(searchValue, currentPage);\n\n    if (currentPage * 40 >= res.totalHits) {\n        iziToast.show({\n           title: '❕',\n           theme: 'dark',\n           message: \"We're sorry, but you've reached the end of search results.\",\n           messageSize: '16px',\n           messageColor: 'white',\n           backgroundColor: '#4e75ff',\n           position: 'topRight',\n           timeout: 5000,\n});\n\nif (res.hits.length > 0) {\n        imageList.insertAdjacentHTML('beforeend', createMarkup(res.hits));\n        gallery.refresh();\n        nextBtn.classList.add('is-hidden');\n        scrollBy();\n        return;\n    }\n} else {\n        imageList.insertAdjacentHTML('beforeend', createMarkup(res.hits));\n        gallery.refresh();\n        scrollBy();\n        nextBtn.classList.remove('is-hidden');\n}\n} catch (err) {\n        handleError(err);\n} finally {\n        hideLoader();\n        loader.classList.add('is-hidden');\n    }\n}\nconst loader = document.querySelector('.loader');\nfunction hideLoader() {\n    setTimeout(() => {\n    loader.style.display = 'none';\n  }, 500);\n}\n\nfunction showLoader() {\n  loader.style.display = 'block';\n}\nfunction scrollBy() {\n  window.scrollBy({\n    top: 640,\n    behavior: 'smooth',\n  });\n}"],"names":["searchForm","imageList","nextBtn","currentPage","searchValue","gallery","SimpleLightbox","handleSearch","nextPage","event","searchInput","iziToast","showLoader","response","fetchImages","createMarkup","scrollBy","err","handleError","hideLoader","query","page","BASE_URL","KEY","axios","hits","comments","downloads","largeImageURL","likes","webformatURL","tags","views","loader","res"],"mappings":"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"}