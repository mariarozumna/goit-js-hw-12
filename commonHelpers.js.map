{"version":3,"file":"commonHelpers.js","sources":["../src/functions/showMessage.js","../src/functions/createMarkup.js","../src/js/refs.js","../src/functions/handleError.js","../src/main.js"],"sourcesContent":["import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nfunction showMessage(customMessage = '') {\n  const errorMessage =\n    customMessage || 'Sorry, there was an error fetching images.';\n  iziToast.show({\n    // iconUrl: icon,\n    theme: 'dark',\n    message: errorMessage,\n    messageSize: '16px',\n    messageColor: 'white',\n    backgroundColor: '#EF4040',\n    position: 'topRight',\n    timeout: 5000,\n  });\n}\n\nexport { showMessage };","export function createMarkup(hits) {\nreturn hits\n    .map(\n    ({\n        comments,\n        downloads,\n        largeImageURL,\n        likes,\n        webformatURL,\n        tags,\n        views,\n    }) =>\n    `<li class=\"gallery-item\">\n        <a class=\"gallery-link\" href=\"${largeImageURL}\">\n            <img class=\"gallery-image\" src=\"${webformatURL}\" alt=\"${tags}\">\n            <ul class=\"gallery-description\">\n              <li class=\"gallery-description-item\">Likes: <span class=\"discrp-item\">${likes}</span> </li>\n              <li class=\"gallery-description-item\">Views: <span class=\"discrp-item\">${views}</span></li>\n              <li class=\"gallery-description-item\">Downloads: <span class=\"discrp-item\">${downloads}</span></li>\n              <li class=\"gallery-description-item\">Comments: <span class=\"discrp-item\">${comments}</span></li>\n            </ul>\n        </a>\n    </li>`\n    )\n    .join('');\n  }","export const refs = {\nsearchForm: document.querySelector('.search-form'),\nimageList: document.querySelector('.gallery'),\nnextBtn: document.querySelector('.next-btn'),\nloader: document.querySelector('.loader'),\n}","export function handleError(err) {\nconsole.error(err);\n    refs.imageList.innerHTML = '';\n    showMessage(err.stack);\n    refs.nextBtn.removeEventListener('click', nextPage);\n    refs.nextBtn.classList.add('is-hidden');\n}","import axios from 'axios';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport { showMessage } from './functions/showMessage';\nimport { createMarkup } from './functions/createMarkup';\nimport { refs } from './js/refs';\nimport { handleError } from './functions/handleError';\n\n    \nlet currentPage = 0;\nlet searchValue = '';\n    \nconst gallery = new SimpleLightbox('.gallery a', {\n    captionsData: 'alt',\n    captionDelay: 250,\n});\n\nrefs.searchForm.addEventListener('submit', handleSearch);\nrefs.nextBtn.addEventListener('click', nextPage);\n  \nasync function handleSearch(event) {\n    event.preventDefault();\n    searchValue = event.currentTarget.elements.query.value.trim();\n    currentPage = 1;    \n    refs.nextBtn.classList.add('is-hidden');\n    refs.imageList.innerHTML = '';\n    showLoader(); \n    if (!searchValue) {\n        showMessage(\n            `Please, fill in the search field`\n        );\n    return;\n}\ntry {\n    const response = await fetchImages(searchValue, currentPage);\n    if (response.hits.length === 0) {\n        showMessage('Sorry, there are no images matching your search query. Please try again!');\n    refs.searchForm.reset();\n    return;\n}\n    refs.imageList.insertAdjacentHTML('beforeend', createMarkup(response.hits));\n    gallery.refresh();\n            \nif (response.hits.length >= 40) {\n    refs.nextBtn.classList.remove('is-hidden');\n} else {\n    showMessage(\"We're sorry, but you've reached the end of search results.\");\n  }\n    refs.searchForm.reset();\n} catch (err) {\n    handleError(err);\n} finally {\n    hideLoader();\n    refs.loader.classList.add('hidden');\n}\n}\n\nasync function fetchImages(query, page) {\n    const BASE_URL = 'https://pixabay.com/api/';\n    const KEY = '41927866-cfb01af7ede59fae11104cea9';\nconst res = await axios.get(BASE_URL, {\n    params: {\n        key: KEY,\n        q: query,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        per_page: 40,\n        page: page,\n    },\n});      \n    return res.data;\n}\n\nasync function nextPage() {\n    refs.loader.classList.remove('hidden');\n    refs.nextBtn.classList.add('is-hidden');\n    currentPage += 1;\n    showLoader();    \ntry {\n    const res = await fetchImages(searchValue, currentPage);\n    if (currentPage * 40 >= res.totalHits) {\n        showMessage(\"We're sorry, but you've reached the end of search results.\");\n\nif (res.hits.length > 0) {\n    refs.imageList.insertAdjacentHTML('beforeend', createMarkup(res.hits));\n    gallery.refresh();\n    refs.nextBtn.classList.add('is-hidden');\n    scrollBy();\n    return;\n}\n} else {\n    refs.imageList.insertAdjacentHTML('beforeend', createMarkup(res.hits));\n    gallery.refresh();\n    refs.nextBtn.classList.remove('is-hidden');\n    scrollBy();\n}\n} catch (err) {\n    handleError(err);\n} finally {\n    hideLoader();\n    refs.loader.classList.add('hidden');\n    }\n}\n\nfunction hideLoader() {\n    setTimeout(() => {\n    refs.loader.style.display = 'none';\n  }, 500);\n}\n\nfunction showLoader() {\n    refs.loader.style.display = 'block';\n}\n\nfunction scrollBy() {\n  window.scrollBy({\n    top:\n    0.7 *\n      document.querySelector('.gallery-item').getBoundingClientRect().height,\n    behavior: 'smooth',\n  });\n}"],"names":["showMessage","customMessage","errorMessage","iziToast","createMarkup","hits","comments","downloads","largeImageURL","likes","webformatURL","tags","views","refs","handleError","err","currentPage","searchValue","gallery","SimpleLightbox","handleSearch","nextPage","event","showLoader","response","fetchImages","hideLoader","query","page","BASE_URL","KEY","axios","res","scrollBy"],"mappings":"owBAEA,SAASA,EAAYC,EAAgB,GAAI,CACvC,MAAMC,EACJD,GAAiB,6CACnBE,EAAS,KAAK,CAEZ,MAAO,OACP,QAASD,EACT,YAAa,OACb,aAAc,QACd,gBAAiB,UACjB,SAAU,WACV,QAAS,GACb,CAAG,CACH,CCfO,SAASE,EAAaC,EAAM,CACnC,OAAOA,EACF,IACD,CAAC,CACG,SAAAC,EACA,UAAAC,EACA,cAAAC,EACA,MAAAC,EACA,aAAAC,EACA,KAAAC,EACA,MAAAC,CACH,IACD;AAAA,wCACoCJ;AAAA,8CACME,WAAsBC;AAAA;AAAA,sFAEkBF;AAAA,sFACAG;AAAA,0FACIL;AAAA,yFACDD;AAAA;AAAA;AAAA,UAIpF,EACA,KAAK,EAAE,CACZ,CCzBO,MAAMO,EAAO,CACpB,WAAY,SAAS,cAAc,cAAc,EACjD,UAAW,SAAS,cAAc,UAAU,EAC5C,QAAS,SAAS,cAAc,WAAW,EAC3C,OAAQ,SAAS,cAAc,SAAS,CACxC,ECLO,SAASC,EAAYC,EAAK,CACjC,QAAQ,MAAMA,CAAG,EACb,KAAK,UAAU,UAAY,GAC3B,YAAYA,EAAI,KAAK,EACrB,KAAK,QAAQ,oBAAoB,QAAS,QAAQ,EAClD,KAAK,QAAQ,UAAU,IAAI,WAAW,CAC1C,CCKA,IAAIC,EAAc,EACdC,EAAc,GAElB,MAAMC,EAAU,IAAIC,EAAe,aAAc,CAC7C,aAAc,MACd,aAAc,GAClB,CAAC,EAEDN,EAAK,WAAW,iBAAiB,SAAUO,CAAY,EACvDP,EAAK,QAAQ,iBAAiB,QAASQ,CAAQ,EAE/C,eAAeD,EAAaE,EAAO,CAO/B,GANAA,EAAM,eAAc,EACpBL,EAAcK,EAAM,cAAc,SAAS,MAAM,MAAM,OACvDN,EAAc,EACdH,EAAK,QAAQ,UAAU,IAAI,WAAW,EACtCA,EAAK,UAAU,UAAY,GAC3BU,IACI,CAACN,EAAa,CACdjB,EACI,kCACZ,EACI,MACJ,CACA,GAAI,CACA,MAAMwB,EAAW,MAAMC,EAAYR,EAAaD,CAAW,EAC3D,GAAIQ,EAAS,KAAK,SAAW,EAAG,CAC5BxB,EAAY,0EAA0E,EAC1Fa,EAAK,WAAW,QAChB,MACJ,CACIA,EAAK,UAAU,mBAAmB,YAAaT,EAAaoB,EAAS,IAAI,CAAC,EAC1EN,EAAQ,QAAO,EAEfM,EAAS,KAAK,QAAU,GACxBX,EAAK,QAAQ,UAAU,OAAO,WAAW,EAEzCb,EAAY,4DAA4D,EAExEa,EAAK,WAAW,OACpB,OAASE,EAAP,CACED,EAAYC,CAAG,CACnB,QAAU,CACNW,IACAb,EAAK,OAAO,UAAU,IAAI,QAAQ,CACtC,CACA,CAEA,eAAeY,EAAYE,EAAOC,EAAM,CACpC,MAAMC,EAAW,2BACXC,EAAM,qCAYZ,OAXQ,MAAMC,EAAM,IAAIF,EAAU,CAClC,OAAQ,CACJ,IAAKC,EACL,EAAGH,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,SAAU,GACV,KAAMC,CACT,CACL,CAAC,GACc,IACf,CAEA,eAAeP,GAAW,CACtBR,EAAK,OAAO,UAAU,OAAO,QAAQ,EACrCA,EAAK,QAAQ,UAAU,IAAI,WAAW,EACtCG,GAAe,EACfO,IACJ,GAAI,CACA,MAAMS,EAAM,MAAMP,EAAYR,EAAaD,CAAW,EACtD,GAAIA,EAAc,IAAMgB,EAAI,WAGhC,GAFQhC,EAAY,4DAA4D,EAE5EgC,EAAI,KAAK,OAAS,EAAG,CACrBnB,EAAK,UAAU,mBAAmB,YAAaT,EAAa4B,EAAI,IAAI,CAAC,EACrEd,EAAQ,QAAO,EACfL,EAAK,QAAQ,UAAU,IAAI,WAAW,EACtCoB,IACA,MACJ,OAEIpB,EAAK,UAAU,mBAAmB,YAAaT,EAAa4B,EAAI,IAAI,CAAC,EACrEd,EAAQ,QAAO,EACfL,EAAK,QAAQ,UAAU,OAAO,WAAW,EACzCoB,GAEJ,OAASlB,EAAP,CACED,EAAYC,CAAG,CACnB,QAAU,CACNW,IACAb,EAAK,OAAO,UAAU,IAAI,QAAQ,CACjC,CACL,CAEA,SAASa,GAAa,CAClB,WAAW,IAAM,CACjBb,EAAK,OAAO,MAAM,QAAU,MAC7B,EAAE,GAAG,CACR,CAEA,SAASU,GAAa,CAClBV,EAAK,OAAO,MAAM,QAAU,OAChC,CAEA,SAASoB,GAAW,CAClB,OAAO,SAAS,CACd,IACA,GACE,SAAS,cAAc,eAAe,EAAE,sBAAuB,EAAC,OAClE,SAAU,QACd,CAAG,CACH"}